start
= _ statement*

statement
= autodeploy
/ publish
/ run
/ comment
/ whiteline

publish
= "PUBLISH"i _ from:port _ "AS"i _ to:port _ url:string _ "\n" { return {'publish': { "from": from, "to": to,  "url": url}};}
/ "PUBLISH"i _ from:port _ "AS"i _ to:port _ "\n" { return {'publish': { "from":
from, "to": to, "url": '/'}};}

autodeploy
= "AUTODEPLOY"i _ url:string _ "\n" { return {"autodeploy": url};}

run
= "RUN"i command:[^\n]* "\n" { return {"command": command.join("")}; }

comment
= "#" comment:[^\n]* "\n" { return {"comment": comment.join("")}; }

whiteline
= _ "\n" { return {}; }

port
= int:int { return parseInt(int.join(""));}

chars
= chars:char+ { return chars.join(""); }

string
= '"' '"'             { return "";    }
/ '"' chars:chars '"' { return chars; }
/ chars:chars         { return chars; }

char
= [^"\\\0-\x1F\x7f]
/ '\\"'  { return '"';  }
/ "\\\\" { return "\\"; }
/ "\\/"  { return "/";  }

_ "whitespace"
= whitespace*

whitespace
= [ \t\r]

int
= digits
/ "-" digits

digits
= digit+

digit
= [0-9]

digit19
= [1-9]
